<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>comunes-angular documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);
          </script>
          <script>
              // --- Iframe navigation tracking for Template Playground ---
              function sendCurrentUrlToParent() {
                  if (window.parent && window.parent !== window) {
                      window.parent.postMessage({
                          type: 'compodoc-iframe-navigate',
                          url: window.location.pathname + window.location.hash
                      }, '*');
                  }
              }
              window.addEventListener('hashchange', sendCurrentUrlToParent, false);
              window.addEventListener('popstate', sendCurrentUrlToParent, false);
              window.addEventListener('DOMContentLoaded', sendCurrentUrlToParent, false);
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-md-none p-0">
               <div class="d-flex">
                    <a href="../" class="navbar-brand">comunes-angular documentation</a>
                    <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
               </div>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="d-none d-md-block menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">

















<ol class="breadcrumb">
  <li class="breadcrumb-item">Interfaces</li>
  <li class="breadcrumb-item"
  >
  Estadisticas</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/features/admin/reportes/reportes.component.ts</code>
        </p>




        <section data-compodoc="block-index">
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#casasAlDia" 
>
                                            casasAlDia
                                        </a>
                                </li>
                                <li>
                                        <a href="#tasaPago" 
>
                                            tasaPago
                                        </a>
                                </li>
                                <li>
                                        <a href="#totalResidentes" 
>
                                            totalResidentes
                                        </a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section data-compodoc="block-properties">
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="casasAlDia"></a>
                                        <span class="name "><b>casasAlDia</b>
                                            <a href="#casasAlDia">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>casasAlDia:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="tasaPago"></a>
                                        <span class="name "><b>tasaPago</b>
                                            <a href="#tasaPago">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>tasaPago:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="totalResidentes"></a>
                                        <span class="name "><b>totalResidentes</b>
                                            <a href="#totalResidentes">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>totalResidentes:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Component, OnInit } from &#x27;@angular/core&#x27;;
import { CommonModule } from &#x27;@angular/common&#x27;;
import { NavbarComponent } from &#x27;../../../shared/components/navbar/navbar.component&#x27;;
import { Gasto } from &#x27;../../../models/gasto.interface&#x27;;
import { Pago } from &#x27;../../../models/pago.interface&#x27;;
import { Usuario } from &#x27;../../../models/usuario.interface&#x27;;

interface Resumen {
  totalGastos: number;
  totalRecaudado: number;
  pendiente: number;
  balance: number;
}

interface Estadisticas {
  tasaPago: number;
  casasAlDia: number;
  totalResidentes: number;
}

@Component({
  selector: &#x27;app-reportes&#x27;,
  standalone: true,
  imports: [CommonModule, NavbarComponent],
  templateUrl: &#x27;./reportes.component.html&#x27;,
  styleUrls: [&#x27;./reportes.component.scss&#x27;]
})
export class ReportesComponent implements OnInit {
  reporteActual: string &#x3D; &#x27;&#x27;;
  mesActual: string &#x3D; &#x27;&#x27;;
  
  gastos: Gasto[] &#x3D; [];
  pagos: Pago[] &#x3D; [];
  residentes: Usuario[] &#x3D; [];
  
  gastosActivos: Gasto[] &#x3D; [];
  pagosMesActual: Pago[] &#x3D; [];
  top5Gastos: Gasto[] &#x3D; [];
  
  resumen: Resumen &#x3D; {
    totalGastos: 0,
    totalRecaudado: 0,
    pendiente: 0,
    balance: 0
  };
  
  estadisticas: Estadisticas &#x3D; {
    tasaPago: 0,
    casasAlDia: 0,
    totalResidentes: 0
  };

  ngOnInit(): void {
    this.establecerMesActual();
    this.cargarDatos();
    this.calcularResumen();
    this.calcularEstadisticas();
  }

  establecerMesActual(): void {
    const ahora &#x3D; new Date();
    const meses &#x3D; [
      &#x27;Enero&#x27;, &#x27;Febrero&#x27;, &#x27;Marzo&#x27;, &#x27;Abril&#x27;, &#x27;Mayo&#x27;, &#x27;Junio&#x27;,
      &#x27;Julio&#x27;, &#x27;Agosto&#x27;, &#x27;Septiembre&#x27;, &#x27;Octubre&#x27;, &#x27;Noviembre&#x27;, &#x27;Diciembre&#x27;
    ];
    this.mesActual &#x3D; &#x60;${meses[ahora.getMonth()]} ${ahora.getFullYear()}&#x60;;
  }

  cargarDatos(): void {
    // Cargar gastos desde localStorage
    const gastosStorage &#x3D; localStorage.getItem(&#x27;gastos&#x27;);
    if (gastosStorage) {
      this.gastos &#x3D; JSON.parse(gastosStorage);
    } else {
      // Si no hay gastos, inicializar con datos de ejemplo
      this.inicializarGastosEjemplo();
    }
    
    // Cargar pagos desde localStorage
    const pagosStorage &#x3D; localStorage.getItem(&#x27;pagos&#x27;);
    if (pagosStorage) {
      this.pagos &#x3D; JSON.parse(pagosStorage);
    } else {
      // Si no hay pagos, inicializar con datos de ejemplo
      this.inicializarPagosEjemplo();
    }
    
    // Cargar residentes desde localStorage
    const usuariosStorage &#x3D; localStorage.getItem(&#x27;usuarios&#x27;);
    if (usuariosStorage) {
      const usuarios: Usuario[] &#x3D; JSON.parse(usuariosStorage);
      this.residentes &#x3D; usuarios.filter(u &#x3D;&gt; u.casa &amp;&amp; u.pasaje);
    } else {
      this.residentes &#x3D; [];
    }

    console.log(&#x27;üìä Datos cargados:&#x27;, {
      gastos: this.gastos.length,
      pagos: this.pagos.length,
      residentes: this.residentes.length
    });
  }

  calcularResumen(): void {
    const fechaActual &#x3D; new Date();
    const mesActual &#x3D; fechaActual.getMonth();
    const a√±oActual &#x3D; fechaActual.getFullYear();
    
    // Filtrar gastos activos (no por mes, sino por estado)
    this.gastosActivos &#x3D; this.gastos.filter(g &#x3D;&gt; 
      g.estado &#x3D;&#x3D;&#x3D; &#x27;Activo&#x27; || g.estado &#x3D;&#x3D;&#x3D; &#x27;aprobado&#x27;
    );
    
    // Filtrar pagos del mes actual
    this.pagosMesActual &#x3D; this.pagos.filter(p &#x3D;&gt; {
      const fechaPago &#x3D; new Date(p.fecha);
      return fechaPago.getMonth() &#x3D;&#x3D;&#x3D; mesActual &amp;&amp; 
             fechaPago.getFullYear() &#x3D;&#x3D;&#x3D; a√±oActual;
    });
    
    // Calcular totales
    this.resumen.totalGastos &#x3D; this.gastosActivos.reduce((sum, g) &#x3D;&gt; sum + g.monto, 0);
    this.resumen.totalRecaudado &#x3D; this.pagosMesActual.reduce((sum, p) &#x3D;&gt; sum + p.monto, 0);
    
    // Calcular pendiente
    const montoPorCasa &#x3D; Math.ceil(this.resumen.totalGastos / 13);
    const totalEsperado &#x3D; montoPorCasa * 13;
    this.resumen.pendiente &#x3D; totalEsperado - this.resumen.totalRecaudado;
    
    // Calcular balance
    this.resumen.balance &#x3D; this.resumen.totalRecaudado - this.resumen.totalGastos;
    
    // Top 5 gastos m√°s altos
    this.top5Gastos &#x3D; [...this.gastosActivos]
      .sort((a, b) &#x3D;&gt; b.monto - a.monto)
      .slice(0, 5);

    console.log(&#x27;üí∞ Resumen calculado:&#x27;, this.resumen);
    console.log(&#x27;üìà Top 5 Gastos:&#x27;, this.top5Gastos);
  }

  calcularEstadisticas(): void {
    // Total residentes
    this.estadisticas.totalResidentes &#x3D; this.residentes.length || 13;
    
    // Tasa de pago
    if (this.resumen.totalGastos &gt; 0) {
      const montoPorCasa &#x3D; Math.ceil(this.resumen.totalGastos / 13);
      const totalEsperado &#x3D; montoPorCasa * 13;
      if (totalEsperado &gt; 0) {
        this.estadisticas.tasaPago &#x3D; Math.round((this.resumen.totalRecaudado / totalEsperado) * 100);
      }
    }
    
    // Casas al d√≠a (contamos cu√°ntas casas diferentes pagaron)
    const casasQuePagaron &#x3D; new Set&lt;string&gt;();
    this.pagosMesActual.forEach(p &#x3D;&gt; {
      const identificador &#x3D; &#x60;${p.pasaje}-${p.casa}&#x60;;
      casasQuePagaron.add(identificador);
    });
    this.estadisticas.casasAlDia &#x3D; casasQuePagaron.size;

    console.log(&#x27;üìä Estad√≠sticas calculadas:&#x27;, this.estadisticas);
  }

  verReporte(tipo: string): void {
    this.reporteActual &#x3D; tipo;
    console.log(&#x27;üìÑ Ver reporte:&#x27;, tipo);
  }

  imprimirReporte(): void {
    window.print();
  }

  /**
   * Inicializa datos de ejemplo para gastos si no existen
   */
  private inicializarGastosEjemplo(): void {
    this.gastos &#x3D; [
      {
        id: 1,
        concepto: &#x27;Mantenci√≥n √Åreas Verdes&#x27;,
        descripcion: &#x27;Poda de √°rboles y mantenci√≥n de jardines&#x27;,
        monto: 350000,
        fecha: new Date(2025, 10, 1).toISOString(),
        estado: &#x27;Activo&#x27;,
        categoria: &#x27;Mantenci√≥n&#x27;
      },
      {
        id: 2,
        concepto: &#x27;Cuenta de Agua&#x27;,
        descripcion: &#x27;Consumo de agua mes actual&#x27;,
        monto: 125000,
        fecha: new Date(2025, 10, 5).toISOString(),
        estado: &#x27;Activo&#x27;,
        categoria: &#x27;Servicios B√°sicos&#x27;
      },
      {
        id: 3,
        concepto: &#x27;Cuenta de Luz&#x27;,
        descripcion: &#x27;Consumo de electricidad √°reas comunes&#x27;,
        monto: 85000,
        fecha: new Date(2025, 10, 5).toISOString(),
        estado: &#x27;Activo&#x27;,
        categoria: &#x27;Servicios B√°sicos&#x27;
      },
      {
        id: 4,
        concepto: &#x27;Servicio de Seguridad&#x27;,
        descripcion: &#x27;Pago mensual servicio de guardia&#x27;,
        monto: 450000,
        fecha: new Date(2025, 10, 1).toISOString(),
        estado: &#x27;Activo&#x27;,
        categoria: &#x27;Seguridad&#x27;
      },
      {
        id: 5,
        concepto: &#x27;Mantenci√≥n Alumbrado&#x27;,
        descripcion: &#x27;Reparaci√≥n de farolas exteriores&#x27;,
        monto: 180000,
        fecha: new Date(2025, 9, 28).toISOString(),
        estado: &#x27;Pagado&#x27;,
        categoria: &#x27;Mantenci√≥n&#x27;
      }
    ];
    localStorage.setItem(&#x27;gastos&#x27;, JSON.stringify(this.gastos));
    console.log(&#x27;‚ú® Gastos de ejemplo inicializados&#x27;);
  }

  /**
   * Inicializa datos de ejemplo para pagos si no existen
   */
  private inicializarPagosEjemplo(): void {
    this.pagos &#x3D; [
      {
        id: 1,
        nombreResidente: &#x27;Juan P√©rez&#x27;,
        email: &#x27;juan.perez@email.com&#x27;,
        pasaje: &#x27;8651&#x27;,
        casa: &#x27;A&#x27;,
        monto: 95000,
        fecha: new Date(2025, 10, 2).toISOString(),
        estado: &#x27;confirmado&#x27;,
        metodoPago: &#x27;Transferencia&#x27;
      },
      {
        id: 2,
        nombreResidente: &#x27;Mar√≠a Gonz√°lez&#x27;,
        email: &#x27;maria.gonzalez@email.com&#x27;,
        pasaje: &#x27;8651&#x27;,
        casa: &#x27;B&#x27;,
        monto: 95000,
        fecha: new Date(2025, 10, 3).toISOString(),
        estado: &#x27;confirmado&#x27;,
        metodoPago: &#x27;Efectivo&#x27;
      },
      {
        id: 3,
        nombreResidente: &#x27;Carlos Rojas&#x27;,
        email: &#x27;carlos.rojas@email.com&#x27;,
        pasaje: &#x27;8707&#x27;,
        casa: &#x27;C&#x27;,
        monto: 95000,
        fecha: new Date(2025, 10, 4).toISOString(),
        estado: &#x27;confirmado&#x27;,
        metodoPago: &#x27;Transferencia&#x27;
      },
      {
        id: 4,
        nombreResidente: &#x27;Ana Mart√≠nez&#x27;,
        email: &#x27;ana.martinez@email.com&#x27;,
        pasaje: &#x27;8651&#x27;,
        casa: &#x27;D&#x27;,
        monto: 95000,
        fecha: new Date(2025, 10, 5).toISOString(),
        estado: &#x27;confirmado&#x27;,
        metodoPago: &#x27;Transferencia&#x27;
      }
    ];
    localStorage.setItem(&#x27;pagos&#x27;, JSON.stringify(this.pagos));
    console.log(&#x27;‚ú® Pagos de ejemplo inicializados&#x27;);
  }

  /**
   * Obtiene la clase CSS para el estado de un gasto
   */
  getEstadoClase(estado: string): string {
    const clases: { [key: string]: string } &#x3D; {
      &#x27;Activo&#x27;: &#x27;badge bg-success&#x27;,
      &#x27;Pendiente&#x27;: &#x27;badge bg-warning&#x27;,
      &#x27;Pagado&#x27;: &#x27;badge bg-info&#x27;,
      &#x27;Vencido&#x27;: &#x27;badge bg-danger&#x27;
    };
    return clases[estado] || &#x27;badge bg-secondary&#x27;;
  }

  /**
   * Obtiene la clase CSS para el balance
   */
  getBalanceClase(): string {
    if (this.resumen.balance &gt; 0) return &#x27;text-success&#x27;;
    if (this.resumen.balance &lt; 0) return &#x27;text-danger&#x27;;
    return &#x27;text-muted&#x27;;
  }
}
</code></pre>
    </div>
</div>








                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'Estadisticas-1.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script>
               $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               checkToggle(darkModeState);
               if ($darkModeToggleSwitchers.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
