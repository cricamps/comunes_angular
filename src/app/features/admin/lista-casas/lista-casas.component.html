<!-- Navbar -->
<app-navbar></app-navbar>

<div class="container mt-4">
  <div class="row">
    <div class="col-12">
      <h2 class="mb-4">
        <i class="bi bi-houses"></i> Casas de la Comunidad
      </h2>
    </div>
  </div>

  <!-- Estadísticas Generales -->
  <div class="row mb-4">
    <div class="col-md-4">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title">Total Casas</h5>
          <h2 class="text-primary">{{ casas.length }}</h2>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title">Total m²</h5>
          <h2 class="text-success">{{ totalMetrosCuadrados }}</h2>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title">Total Habitantes</h5>
          <h2 class="text-info">{{ totalHabitantes }}</h2>
        </div>
      </div>
    </div>
  </div>

  <!-- Mensaje de carga -->
  <div *ngIf="cargando" class="text-center my-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <p class="mt-2">Cargando información de las casas...</p>
  </div>

  <!-- Mensaje de error -->
  <div *ngIf="error" class="alert alert-danger" role="alert">
    <i class="bi bi-exclamation-triangle"></i> {{ error }}
  </div>

  <!-- Lista de casas -->
  <div *ngIf="!cargando && !error">
    <!-- Pasaje 8651 -->
    <div class="row mb-4">
      <div class="col-12">
        <h4 class="mb-3">
          <i class="bi bi-sign-turn-right"></i> Pasaje 8651
          <span class="badge bg-primary ms-2">{{ casasPasaje8651.length }} casas</span>
        </h4>
        <div class="row">
          <div class="col-md-6 col-lg-4 mb-3" *ngFor="let casa of casasPasaje8651">
            <div class="card h-100">
              <div class="card-header d-flex justify-content-between align-items-center">
                <strong>{{ casa.numeroCasa }}</strong>
                <span [ngClass]="getEstadoClase(casa.activa)">
                  {{ getEstadoTexto(casa.activa) }}
                </span>
              </div>
              <div class="card-body">
                <h6 class="card-subtitle mb-2 text-muted">
                  <i class="bi bi-person-circle"></i> {{ casa.residente.nombre }}
                </h6>
                <ul class="list-unstyled small">
                  <li><strong>RUT:</strong> {{ casa.residente.rut }}</li>
                  <li><strong>Email:</strong> {{ casa.residente.email }}</li>
                  <li><strong>Teléfono:</strong> {{ casa.residente.telefono }}</li>
                  <li class="mt-2">
                    <i class="bi bi-rulers"></i> {{ casa.metrosCuadrados }} m²
                  </li>
                  <li>
                    <i class="bi bi-people"></i> {{ casa.cantidadHabitantes }} habitantes
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Pasaje 8707 -->
    <div class="row">
      <div class="col-12">
        <h4 class="mb-3">
          <i class="bi bi-sign-turn-right"></i> Pasaje 8707
          <span class="badge bg-primary ms-2">{{ casasPasaje8707.length }} casas</span>
        </h4>
        <div class="row">
          <div class="col-md-6 col-lg-4 mb-3" *ngFor="let casa of casasPasaje8707">
            <div class="card h-100">
              <div class="card-header d-flex justify-content-between align-items-center">
                <strong>{{ casa.numeroCasa }}</strong>
                <span [ngClass]="getEstadoClase(casa.activa)">
                  {{ getEstadoTexto(casa.activa) }}
                </span>
              </div>
              <div class="card-body">
                <h6 class="card-subtitle mb-2 text-muted">
                  <i class="bi bi-person-circle"></i> {{ casa.residente.nombre }}
                </h6>
                <ul class="list-unstyled small">
                  <li><strong>RUT:</strong> {{ casa.residente.rut }}</li>
                  <li><strong>Email:</strong> {{ casa.residente.email }}</li>
                  <li><strong>Teléfono:</strong> {{ casa.residente.telefono }}</li>
                  <li class="mt-2">
                    <i class="bi bi-rulers"></i> {{ casa.metrosCuadrados }} m²
                  </li>
                  <li>
                    <i class="bi bi-people"></i> {{ casa.cantidadHabitantes }} habitantes
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
